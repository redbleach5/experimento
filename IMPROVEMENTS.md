# Улучшения загрузки моделей

## Что исправлено:

### 1. Улучшена загрузка моделей в `agent.py`:
- ✅ Добавлены повторные попытки (3 попытки с увеличивающимися таймаутами)
- ✅ Обработка ошибки 502 с ожиданием
- ✅ Извлечение ID моделей из разных полей (id, model, name)
- ✅ Сохранение списка доступных моделей в `self.available_models`
- ✅ Использование модели из конфига, если API не отвечает

### 2. Улучшена загрузка моделей в `gui.py`:
- ✅ Повторные попытки подключения (3 попытки)
- ✅ Обработка ошибки 502 с ожиданием
- ✅ Если API не отвечает - используется модель из config.yaml
- ✅ Показ стандартных моделей, если ничего не найдено
- ✅ GUI автоматически загружает модель из конфига при старте

### 3. Улучшено отображение:
- ✅ Показ всех найденных моделей в консоли
- ✅ Обновление списка моделей в GUI
- ✅ Информативные сообщения о статусе

## Как это работает:

1. **При инициализации агента:**
   - Пробует подключиться к `/v1/models` (3 попытки)
   - Если успешно - загружает все модели
   - Если 502 - ждет и пробует снова
   - Если не удалось - использует модель из config.yaml

2. **В GUI:**
   - При выборе провайдера "lmstudio" загружает модели
   - Показывает все найденные модели в выпадающем списке
   - Если API не отвечает - показывает модель из конфига
   - Позволяет выбрать модель вручную

## Текущая модель в конфиге:

Модель: `qwen3-30b-a3b-instruct-2507`

Эта модель будет использоваться, даже если API не отвечает.

## Что делать:

1. **Перезапустите GUI:**
   ```bash
   python gui.py
   ```

2. **В GUI:**
   - Выберите провайдер "lmstudio"
   - Нажмите "Обновить список моделей"
   - Должна появиться модель `qwen3-30b-a3b-instruct-2507`
   - Если API работает - появятся все доступные модели

3. **Если модель не видна:**
   - Проверьте config.yaml - модель должна быть указана
   - GUI покажет модель из конфига, даже если API не работает

